webpackJsonp([10],{"8DT7":function(t,e){},IvP6:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"rules-view",components:{RuleActions:s("eDC2").a},props:{},data:function(){return{timer:0,rule:{for:[],metrics:{}},dialogVisible:!1,tableData:[]}},methods:{viewRule:function(t){this.rule=t,this.dialogVisible=!0},handleDelete:function(t){var e=this;this.$confirm(this.$t("rule.confirm_stop_delete"),"Notice",{confirmButtonClass:"confirm-btn",confirmButtonText:this.$t("oper.confirm"),cancelButtonClass:"cache-btn el-button--text",cancelButtonText:this.$t("oper.cancel"),type:"warning"}).then(function(){e.$httpDelete("/rules/"+t.id).then(function(){e.$message.success(e.$t("rule.delete_success")),e.loadData()})}).catch()},handleOperation:function(){this.$router.push("/rules/0?oper=create")},loadData:function(){var t=this;this.$httpGet("/rules").then(function(e){t.tableData=e.data;var s=t.tableData.find(function(e){return e.id===t.rule.id});s&&(t.rule=s)})}},filters:{actionsFilter:function(t){return t.map(function(t){return t.name}).join(",  ")}},created:function(){var t=this;this.loadData(),clearInterval(this.timer),this.timer=setInterval(function(){t.loadData()},1e4)},beforeRouteLeave:function(t,e,s){clearInterval(this.timer),s()}},a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rules-view"},[s("div",{staticClass:"page-title"},[t._v("\n    "+t._s(t.$t("rule.message_rule"))+"\n    "),s("el-button",{staticClass:"confirm-btn",staticStyle:{float:"right"},attrs:{round:"",plain:"",type:"success",icon:"el-icon-plus",size:"medium",disable:t.$store.state.loading},on:{click:t.handleOperation}},[t._v("\n      "+t._s(t.$t("rule.create"))+"\n    ")])],1),t._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.$store.state.loading,expression:"$store.state.loading"}],attrs:{border:"",data:t.tableData}},[s("el-table-column",{attrs:{prop:"id",label:t.$t("rule.id")},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[s("span",{staticClass:"btn",on:{click:function(e){return t.viewRule(i)}}},[t._v("\n          "+t._s(i.id)+"\n        ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"for",label:t.$t("rule.trigger_events")}}),t._v(" "),s("el-table-column",{attrs:{prop:"rawsql","min-width":"120px",label:"SQL"}}),t._v(" "),s("el-table-column",{attrs:{prop:"actions",label:t.$t("rule.actions")},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return t._l(i.actions,function(e,i){return s("div",{key:i,staticClass:"action-item"},[t._v("\n          "+t._s(e.name)+"\n        ")])})}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"metrics","min-width":"120px",label:t.$t("rule.metrics")},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[s("el-button-group",[s("el-button",{attrs:{size:"mini",type:"success",plain:""}},[s("i",{staticClass:"fa fa-tachometer",attrs:{"aria-hidden":"true"}})]),t._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top",content:t.$t("rule.speed")}},[s("el-button",{attrs:{size:"mini",type:"success",plain:""}},[t._v("\n              "+t._s(i.metrics.speed)+"/s\n            ")])],1),t._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top",content:t.$t("rule.speed_max")}},[s("el-button",{attrs:{size:"mini",type:"success",plain:""}},[t._v("\n              "+t._s(i.metrics.speed_max)+"/s\n            ")])],1),t._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top",content:t.$t("rule.speed_last5m")}},[s("el-button",{attrs:{size:"mini",type:"success",plain:""}},[t._v("\n              "+t._s(i.metrics.speed_last5m)+"/s\n            ")])],1)],1),t._v(" "),s("el-button-group",[s("el-button",{attrs:{size:"mini",type:"success",plain:""}},[s("i",{staticClass:"fa fa-filter",attrs:{"aria-hidden":"true"}})]),t._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top",content:t.$t("rule.rule_matched")}},[s("el-button",{attrs:{size:"mini",type:"success",plain:""}},[t._v("\n              "+t._s(i.metrics.matched)+"\n            ")])],1),t._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top",content:t.$t("rule.rule_nomatch")}},[s("el-button",{attrs:{size:"mini",type:"success",plain:""}},[t._v("\n              "+t._s(i.metrics.nomatch)+"\n            ")])],1)],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{label:t.$t("rule.oper")},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[s("el-button",{attrs:{type:"success",size:"mini",plain:""},on:{click:function(e){return t.viewRule(i)}}},[t._v("\n          "+t._s(t.$t("rule.view"))+"\n        ")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(e){return t.handleDelete(i)}}},[t._v("\n          "+t._s(t.$t("rule.delete"))+"\n        ")])]}}])})],1),t._v(" "),s("el-dialog",{attrs:{title:t.$t("rule.rule_details"),visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("div",{staticClass:"dialog-preview"},[s("div",{staticClass:"option-item"},[s("div",{staticClass:"option-title"},[t._v(t._s(t.$t("rule.id")))]),t._v(" "),s("div",{staticClass:"option-value"},[t._v(t._s(t.rule.id))])]),t._v(" "),s("div",{staticClass:"option-item"},[s("div",{staticClass:"option-title"},[t._v(t._s(t.$t("rule.trigger_events")))]),t._v(" "),s("div",{staticClass:"option-value"},[t._v(t._s((t.rule.for||[]).join(",")))])]),t._v(" "),s("div",{staticClass:"option-item"},[s("div",{staticClass:"option-title"},[t._v(t._s(t.$t("rule.rule_desc")))]),t._v(" "),s("div",{staticClass:"option-value"},[t._v(t._s(t.rule.description))])]),t._v(" "),s("div",{staticClass:"option-item"},[s("div",{staticClass:"option-title"},[t._v("SQL")]),t._v(" "),s("div",{staticClass:"option-value"},[t._v(t._s(t.rule.rawsql))])]),t._v(" "),s("div",{staticClass:"option-item"},[s("div",{staticClass:"option-title"},[t._v(t._s(t.$t("rule.metrics")))]),t._v(" "),s("div",{staticClass:"option-value"},[s("el-tag",{attrs:{size:"mini",type:"info",plain:""}},[t._v("\n            "+t._s(t.$t("rule.speed_current"))+" "+t._s(t.rule.metrics.speed)+"/s\n          ")]),t._v(" "),s("el-tag",{attrs:{size:"mini",type:"info",plain:""}},[t._v("\n            "+t._s(t.$t("rule.speed_max_1"))+" "+t._s(t.rule.metrics.speed_max)+"/s\n          ")]),t._v(" "),s("el-tag",{attrs:{size:"mini",type:"info",plain:""}},[t._v("\n            "+t._s(t.$t("rule.speed_last5m_1"))+" "+t._s(t.rule.metrics.speed_last5m)+"/s\n          ")]),t._v(" "),s("div",[s("el-tag",{attrs:{size:"mini",type:"info",plain:""}},[t._v("\n              "+t._s(t.$t("rule.rule_matched_1"))+" "+t._s(t.rule.metrics.matched)+"\n            ")]),t._v(" "),s("el-tag",{attrs:{size:"mini",type:"info",plain:""}},[t._v("\n              "+t._s(t.$t("rule.rule_nomatch_1"))+" "+t._s(t.rule.metrics.nomatch)+"\n            ")])],1)],1)]),t._v(" "),s("el-table-column",{attrs:{prop:"description",label:t.$t("rule.description")}}),t._v(" "),s("div",{staticClass:"option-item"},[s("div",{staticClass:"option-title"},[t._v(t._s(t.$t("rule.actions")))]),t._v(" "),s("div",{staticClass:"option-all"},[s("rule-actions",{attrs:{"in-dialog":"",record:t.rule,operations:[]}})],1)])],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticClass:"confirm-btn",attrs:{type:"success"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("\n        "+t._s(t.$t("rule.confirm"))+"\n      ")])],1)])],1)},staticRenderFns:[]};var n=s("VU/8")(i,a,!1,function(t){s("8DT7")},null,null);e.default=n.exports}});